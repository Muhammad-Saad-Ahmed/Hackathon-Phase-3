<!--
SYNC IMPACT REPORT
==================
Version change: Initial → 1.0.0
Change Type: MAJOR - Initial constitution creation for Todo AI Chatbot project

Modified principles:
- All 16 principles defined from user input (Core Laws 1-16)

Added sections:
- Core Principles (16 principles)
- Technology Stack Requirements
- State Management Requirements
- Governance

Removed sections: None (initial version)

Templates requiring updates:
✅ .specify/templates/plan-template.md - Constitution Check section will reference these principles
✅ .specify/templates/spec-template.md - Requirements section aligns with SDD principle
✅ .specify/templates/tasks-template.md - Task types align with AI-generated code principle
✅ .specify/templates/commands/*.md - Generic guidance maintained

Follow-up TODOs: None - all placeholders filled
-->

# Todo AI Chatbot (Reusable Intelligence + MCP) Constitution

## Core Principles

### I. Spec-Driven Development

ALL development MUST follow the Spec-Driven Development (SDD) methodology. No implementation begins without:
- Complete feature specification (spec.md)
- Architectural plan (plan.md)
- Detailed, testable task breakdown (tasks.md)

**Rationale**: SDD ensures clarity, reduces rework, and maintains alignment between requirements and implementation. Manual coding without specifications leads to scope drift and technical debt.

### II. AI-Generated Code Only

NO manual coding is permitted at any stage of development. ALL code MUST be generated by AI agents using approved tooling and workflows.

**Rationale**: Consistency, repeatability, and adherence to patterns are guaranteed when AI generates code. Manual intervention introduces unpredictability and breaks the reusability model.

### III. Reusable Intelligence

Agents and skills MUST be designed as reusable intelligence units that can be composed, chained, and applied across multiple contexts without modification.

**Rationale**: Building reusable agents creates compounding value. Each new capability enhances the entire system rather than solving a single-use case.

### IV. Stateless Backend Architecture

The backend MUST be completely stateless. NO in-memory state, session data, or transient storage is allowed. All state MUST persist in the database.

**Rationale**: Stateless architecture ensures the system survives restarts, scales horizontally, and maintains consistency across distributed deployments.

### V. Database as Single Source of Truth

ALL application state MUST be persisted in Neon PostgreSQL. No alternative storage mechanisms (files, caches, in-memory stores) are permitted for state persistence.

**Rationale**: Single source of truth eliminates sync issues, simplifies recovery, and provides clear audit trails for all state changes.

### VI. MCP-Only Agent Interactions

Agents MUST interact with the system ONLY through Model Context Protocol (MCP) tools. Direct function calls, API bypasses, or hardcoded logic are prohibited.

**Rationale**: MCP provides a standardized, secure, and auditable interface for agent actions. Bypassing MCP breaks tooling guarantees and observability.

### VII. Official MCP SDK Mandate

The MCP server MUST use the Official MCP SDK. No custom implementations, wrappers, or alternative protocols are permitted.

**Rationale**: The official SDK ensures compatibility, receives security updates, and maintains protocol compliance with the ecosystem.

### VIII. OpenAI Agents SDK Requirement

All agent logic MUST use the OpenAI Agents SDK. No alternative agent frameworks or custom agent implementations are allowed.

**Rationale**: Standardizing on OpenAI Agents SDK ensures best practices, ongoing support, and integration with the broader AI tooling ecosystem.

### IX. FastAPI Backend Framework

The backend MUST be built with FastAPI. No alternative Python web frameworks are permitted.

**Rationale**: FastAPI provides async support, automatic OpenAPI documentation, type safety, and high performance - all critical for AI agent interactions.

### X. SQLModel ORM Requirement

Database interactions MUST use SQLModel as the ORM. No raw SQL, alternative ORMs, or query builders are permitted.

**Rationale**: SQLModel combines Pydantic validation with SQLAlchemy power, providing type safety and seamless integration with FastAPI.

### XI. ChatKit Frontend Framework

The frontend MUST use ChatKit for UI components and chat interfaces. No custom chat UIs or alternative frameworks are allowed.

**Rationale**: ChatKit provides production-ready chat interfaces optimized for AI interactions, reducing development time and ensuring UX consistency.

### XII. Better Auth Authentication

Authentication MUST be implemented using Better Auth. No custom auth solutions or alternative libraries are permitted.

**Rationale**: Better Auth provides secure, standards-compliant authentication with minimal configuration, reducing security risks from custom implementations.

### XIII. Tool Chaining Support

The system MUST support tool chaining where one tool's output can become another tool's input. Agents must be able to orchestrate multi-step workflows.

**Rationale**: Complex tasks require composition of simpler operations. Tool chaining enables sophisticated agent behaviors without hardcoding workflows.

### XIV. Graceful Error Handling

ALL errors MUST be handled gracefully with clear, actionable messages. No uncaught exceptions, generic error messages, or silent failures are permitted.

**Rationale**: AI agents and users require clear feedback to recover from errors. Poor error handling breaks agent reasoning and user trust.

### XV. Restart Resilience

The system MUST survive and recover from server restarts without data loss or state corruption. No critical operations can rely on runtime-only state.

**Rationale**: Production systems restart for deployments, updates, and failures. Restart resilience is non-negotiable for reliability.

### XVI. No Hardcoded Business Logic

Business logic MUST NOT be hardcoded in the backend. Logic should be configurable, agent-driven, or defined through declarative specifications.

**Rationale**: Hardcoded logic requires code changes for business rule updates. Agent-driven and configurable logic enables runtime adaptation without redeployment.

## Technology Stack Requirements

### Required Technologies (MUST Use)

- **Database**: Neon PostgreSQL (managed PostgreSQL)
- **Backend Framework**: FastAPI (Python)
- **ORM**: SQLModel
- **Agent SDK**: OpenAI Agents SDK
- **MCP Implementation**: Official MCP SDK
- **Frontend Framework**: ChatKit
- **Authentication**: Better Auth

### Prohibited Technologies (MUST NOT Use)

- Alternative web frameworks (Flask, Django, etc.)
- Alternative ORMs (raw SQLAlchemy, Peewee, etc.)
- Custom agent frameworks
- Custom MCP implementations
- In-memory state stores (Redis, Memcached for state)
- Custom authentication systems

## State Management Requirements

### Persistence Rules

1. ALL user data MUST be in PostgreSQL
2. ALL conversation history MUST be in PostgreSQL
3. ALL agent state MUST be in PostgreSQL
4. ALL tool execution logs MUST be in PostgreSQL
5. NO state in backend memory beyond single request scope
6. NO state in filesystem beyond logs and static assets
7. NO state in external caches unless read-through from database

### Database Access Rules

1. Agents MUST access database ONLY through MCP tools
2. Backend MAY access database directly for request handling
3. NO direct database connections from frontend
4. ALL database operations MUST use SQLModel
5. ALL schema changes MUST use migrations

## Governance

### Amendment Procedure

1. Proposed amendments MUST be documented with rationale
2. Amendments require approval from project leadership
3. Constitution version MUST be incremented per semantic versioning:
   - MAJOR: Backward incompatible changes (principle removal/redefinition)
   - MINOR: New principles or sections added
   - PATCH: Clarifications, wording fixes, non-semantic changes
4. All dependent templates and documentation MUST be updated after amendments

### Compliance Requirements

1. ALL pull requests MUST verify constitution compliance
2. ALL architecture decisions MUST reference constitution principles
3. Violations MUST be justified in writing and approved
4. Complexity that violates principles MUST document why simpler alternatives were rejected

### Version Control

Constitution changes MUST be tracked in version control with clear commit messages following the format:
`docs: amend constitution to v[VERSION] ([brief description of changes])`

**Version**: 1.0.0 | **Ratified**: 2026-01-16 | **Last Amended**: 2026-01-16
